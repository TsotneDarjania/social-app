(()=>{"use strict";const e={authenticatedContent:document.getElementById("authenticated-content"),unauthenticatedContent:document.getElementById("unauthenticated-content")},t={loginForm:document.getElementById("login-form"),signupForm:document.getElementById("sign-up-form"),loginEmail:document.getElementById("loginEmail"),loginPassword:document.getElementById("loginPassword"),registrationEmail:document.getElementById("reg-email"),registrationPassword:document.getElementById("reg-password"),registrationUserName:document.getElementById("reg-username"),signUpButton:document.getElementById("sign-up-button"),loginButton:document.getElementById("LoginBtn"),createAccountBtn:document.getElementById("createAccountBtn"),closeRegistrationFormBtn:document.getElementById("closeRegistrationFormBtn")},n={header:document.getElementById("header"),userProfile:document.getElementById("userProfile"),userName:document.getElementById("userName"),logoutBtn:document.getElementById("logoutBtn")},o=()=>{t.loginForm.style.display="none",t.signupForm.style.display="block"},s=()=>{t.signupForm.style.display="none",t.loginForm.style.display="block"},i=async(e,t,n)=>{const o=await fetch(e,{method:t,body:n,headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error("Network response was not ok");return o},r="http://localhost:3000",a=()=>{const e=t.loginEmail.value,n=t.loginPassword.value,o=`${r}/api/user/login`,s=JSON.stringify({email:e,password:n});i(o,"POST",s).then((e=>{if(401!==e.status)return e.json();alert("Invalid email or password")})).then((e=>{if(e){if(e.errors){const t=e.errors[0];alert(t)}console.log(e),"success"==e&&window.location.reload()}}))},l=()=>{const e=t.registrationEmail.value,n=t.registrationPassword.value,o=t.registrationUserName.value;if(!((e,t,n)=>""!==e&&""!==t&&""!==n)(e,n,o))return void alert("Please fill in all fields");const a=`${r}/api/user/register`,l=JSON.stringify({email:e,password:n,username:o});i(a,"POST",l).then((e=>e.json())).then((e=>{if(e.errors){const t=e.errors[0];alert(t)}console.log(e)})).then((()=>s()))},d=async()=>{i(`${r}/api/user/logout`,"POST").then((e=>e.json())).then((e=>{"success"===e?window.location.reload():alert("Failed to log out")}))};window.addEventListener("DOMContentLoaded",(()=>{"true"===window.userData.authenticated?(e.authenticatedContent.style.display="block",n.userName.innerHTML=window.userData.username):e.unauthenticatedContent.style.display="block",t.signUpButton.addEventListener("click",l),t.loginButton.addEventListener("click",a),n.logoutBtn.addEventListener("click",d),t.createAccountBtn.addEventListener("click",o),t.closeRegistrationFormBtn.addEventListener("click",s)}))})();